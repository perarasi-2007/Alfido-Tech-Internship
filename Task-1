import os
import logging

logging.basicConfig(
    filename="file_automation.log",
    level=logging.INFO,C:\Users\Perarasi\OneDrive
    format="%(asctime)s - %(levelname)s - %(message)s"
)

def rename_files(folder_path, prefix):
    try:
        for file in os.listdir(folder_path):
            old_path = os.path.join(folder_path, file)
            if os.path.isfile(old_path):
                new_name = prefix + file
                os.rename(old_path, os.path.join(folder_path, new_name))
                logging.info(f"Renamed {file} to {new_name}")
        print("Files renamed successfully")
    except Exception as e:
        logging.error(e)
        print("Error while renaming")

def sort_files(folder_path):
    try:
        for file in os.listdir(folder_path):
            path = os.path.join(folder_path, file)
            if os.path.isfile(path):
                ext = file.split('.')[-1].upper()
                folder = os.path.join(folder_path, ext)

                if not os.path.exists(folder):
                    os.mkdir(folder)

                os.rename(path, os.path.join(folder, file))
                logging.info(f"Moved {file} to {ext} folder")
        print("Files sorted successfully")
    except Exception as e:
        logging.error(e)
        print("Error while sorting")

def clean_empty_folders(folder_path):
    try:
        for root, dirs, files in os.walk(folder_path, topdown=False):
            for d in dirs:
                dir_path = os.path.join(root, d)
                if not os.listdir(dir_path):
                    os.rmdir(dir_path)
                    logging.info(f"Removed empty folder {dir_path}")
        print("Empty folders cleaned")
    except Exception as e:
        logging.error(e)
        print("Error while cleaning")

def main():
    print("\nFILE AUTOMATION TOOL")
    print("1. Rename files")
    print("2. Sort files by extension")
    print("3. Clean empty folders")

    choice = input("Enter your choice (1/2/3): ")
    folder_path = input("Enter folder path: ")

    if not os.path.exists(folder_path):
        print("Invalid folder path")
        return

    if choice == "1":
        prefix = input("Enter prefix: ")
        rename_files(folder_path, prefix)
    elif choice == "2":
        sort_files(folder_path)
    elif choice == "3":
        clean_empty_folders(folder_path)
    else:
        print("Invalid choice")

if __name__ == "__main__":
    main()
